# =============================================================================
# Code Executor Configuration
# =============================================================================
# Loaded via env_file in docker-compose.yml
# Environment definitions are in config/environments.yaml
#
# NOTE: При изменении портов здесь также обновите docker-compose.yml
# =============================================================================

# -----------------------------------------------------------------------------
# Redis Configuration
# -----------------------------------------------------------------------------
# Hostname "redis" соответствует имени сервиса в docker-compose.yml
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0

# -----------------------------------------------------------------------------
# Celery Configuration
# -----------------------------------------------------------------------------
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0
CELERY_WORKER_CONCURRENCY=4

# -----------------------------------------------------------------------------
# Docker Configuration
# -----------------------------------------------------------------------------
DOCKER_SOCKET=/var/run/docker.sock
DOCKER_IMAGE_PREFIX=code-executor

# -----------------------------------------------------------------------------
# Execution Limits
# -----------------------------------------------------------------------------
# Memory limit per container (e.g., "256m", "512m", "1g")
CONTAINER_MEMORY_LIMIT=256m

# CPU limit (fraction of 1 CPU, e.g., 0.5 = 50% of one CPU)
CONTAINER_CPU_LIMIT=0.5

# Maximum number of processes in container
CONTAINER_PIDS_LIMIT=50

# Maximum execution time in seconds
EXECUTION_TIMEOUT=30

# Session TTL in seconds (how long a session lives)
SESSION_TTL=3600

# -----------------------------------------------------------------------------
# Security Settings
# -----------------------------------------------------------------------------
# Disable network access in containers
NETWORK_DISABLED=true

# Run containers in read-only mode (workspace is writable)
READ_ONLY=false

# Prevent privilege escalation
NO_NEW_PRIVILEGES=true

# tmpfs size for /tmp
TMPFS_SIZE=64m

# -----------------------------------------------------------------------------
# API Settings
# -----------------------------------------------------------------------------
# Порт внутри контейнера. При изменении обновите также:
#   - docker-compose.yml (ports секция для api сервиса)
#   - Dockerfile (EXPOSE директива)
API_HOST=0.0.0.0
API_PORT=8000
API_DEBUG=false

# -----------------------------------------------------------------------------
# Nginx Proxy Manager
# -----------------------------------------------------------------------------
# NPM настраивается через веб-интерфейс:
#   - Admin UI: http://localhost:81
#   - Default login: admin@example.com / changeme (ОБЯЗАТЕЛЬНО СМЕНИТЕ!)
#
# Рекомендуемая настройка Proxy Host в NPM:
#   - Domain: your-domain.com (или localhost для локальной разработки)
#   - Scheme: http
#   - Forward Hostname: api (имя сервиса в docker-compose)
#   - Forward Port: 8000
# -----------------------------------------------------------------------------
